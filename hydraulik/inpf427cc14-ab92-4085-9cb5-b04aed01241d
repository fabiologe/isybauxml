<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>swmmio map</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.10.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.10.0/mapbox-gl.css' rel='stylesheet' />
    <link href='https://www.mapbox.com/base/latest/base.css' rel='stylesheet' />
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
</head>
<body>

<div id='map'></div>

<script>
mapboxgl.accessToken = 'pk.eyJ1IjoiZW1uZXQiLCJhIjoiY2pscGFpZjRlMjJmdDNsbjNycDN6a3J0OCJ9.wYmEb0AnxVVMKVhs2ns89A';
var map = new mapboxgl.Map({
    style:'mapbox://styles/emnet/ckjt4ym0q00cz19ob1y62adi5',
    // center: [-75.148946, 39.921685],
	center:[6.5943172824002945, 9.985261572624433],
    zoom: 15,
    container: 'map',
});

	map.fitBounds([[6.593773539435654, 9.984738836533078], [6.594828379903037, 9.98556525447384]]);
conduits = {"type": "FeatureCollection", "features": []}
nodes = {"type": "FeatureCollection", "features": [{"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.59407, 9.985159]}, "properties": {"InvertElev": 38.48, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119001"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594165, 9.985122]}, "properties": {"InvertElev": 38.46, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119002"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594246, 9.98509]}, "properties": {"InvertElev": 38.4, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119003"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594219, 9.98501]}, "properties": {"InvertElev": 38.38, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119004"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594255, 9.985005]}, "properties": {"InvertElev": 38.76, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119004B01"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594238, 9.985007]}, "properties": {"InvertElev": 38.66, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119004SF01"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594297, 9.985]}, "properties": {"InvertElev": 38.74, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119005"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594345, 9.985125]}, "properties": {"InvertElev": 38.65, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119007"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594389, 9.985237]}, "properties": {"InvertElev": 38.65, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119008"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594424, 9.985326]}, "properties": {"InvertElev": 38.65, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119009"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594461, 9.985414]}, "properties": {"InvertElev": 38.6, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119010"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594358, 9.985449]}, "properties": {"InvertElev": 38.62, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119011"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594351, 9.985472]}, "properties": {"InvertElev": 38.7, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119012"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594307, 9.985495]}, "properties": {"InvertElev": 38.9, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119012B01"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594305, 9.985489]}, "properties": {"InvertElev": 38.87, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119012B02"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594303, 9.985483]}, "properties": {"InvertElev": 38.82, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119012B03"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594336, 9.985485]}, "properties": {"InvertElev": 38.78, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119012SF01"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594334, 9.985479]}, "properties": {"InvertElev": 38.72, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119012SF02"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594331, 9.985472]}, "properties": {"InvertElev": 38.65, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119012SF03"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594294, 9.985495]}, "properties": {"InvertElev": 38.76, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119013"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594226, 9.985488]}, "properties": {"InvertElev": 38.71, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119014"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594154, 9.985481]}, "properties": {"InvertElev": 38.72, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119015"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594148, 9.985467]}, "properties": {"InvertElev": 38.63, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119015A"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594047, 9.985514]}, "properties": {"InvertElev": 39.0, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119016AUSF"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594828, 9.985352]}, "properties": {"InvertElev": 38.66, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119017"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594795, 9.985364]}, "properties": {"InvertElev": 38.69, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119018"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594753, 9.98538]}, "properties": {"InvertElev": 38.68, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119019"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594764, 9.985407]}, "properties": {"InvertElev": 38.67, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119020"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594626, 9.98546]}, "properties": {"InvertElev": 38.66, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119021"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594492, 9.985513]}, "properties": {"InvertElev": 38.62, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119022"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594356, 9.985565]}, "properties": {"InvertElev": 38.8, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119023"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594298, 9.985011]}, "properties": {"InvertElev": 38.6, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119024"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594339, 9.985118]}, "properties": {"InvertElev": 38.59, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119025"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.59438, 9.985224]}, "properties": {"InvertElev": 38.59, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119026"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594424, 9.985335]}, "properties": {"InvertElev": 38.61, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119027"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594456, 9.985411]}, "properties": {"InvertElev": 38.64, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119028"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.59446, 9.98542]}, "properties": {"InvertElev": 38.65, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119029"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594471, 9.985454]}, "properties": {"InvertElev": 38.99, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119029A"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594256, 9.985486]}, "properties": {"InvertElev": 38.69, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119030"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594368, 9.98497]}, "properties": {"InvertElev": 38.78, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119031"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594417, 9.985094]}, "properties": {"InvertElev": 38.65, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119032"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594462, 9.985209]}, "properties": {"InvertElev": 38.66, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119033"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594512, 9.985334]}, "properties": {"InvertElev": 38.74, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119034"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594535, 9.985389]}, "properties": {"InvertElev": 38.62, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119035"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594567, 9.985169]}, "properties": {"InvertElev": 38.65, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119036"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594616, 9.985298]}, "properties": {"InvertElev": 38.61, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119037"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594635, 9.985351]}, "properties": {"InvertElev": 38.64, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119038"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594817, 9.98529]}, "properties": {"InvertElev": 38.74, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119039"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594714, 9.985326]}, "properties": {"InvertElev": 38.69, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119040"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594664, 9.985131]}, "properties": {"InvertElev": 38.74, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119042"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594713, 9.985259]}, "properties": {"InvertElev": 38.73, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119043"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594738, 9.985311]}, "properties": {"InvertElev": 38.64, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119044"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594761, 9.985097]}, "properties": {"InvertElev": 38.69, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119045"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594806, 9.985227]}, "properties": {"InvertElev": 38.8, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119046"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594814, 9.985283]}, "properties": {"InvertElev": 38.69, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119047"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.59402, 9.985076]}, "properties": {"InvertElev": 38.44, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119056"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594086, 9.985051]}, "properties": {"InvertElev": 38.42, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119057"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594171, 9.985018]}, "properties": {"InvertElev": 38.48, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "119058"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.593774, 9.984739]}, "properties": {"InvertElev": 39.32, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120001"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.593827, 9.984873]}, "properties": {"InvertElev": 38.93, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120002"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.593875, 9.984995]}, "properties": {"InvertElev": 38.52, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120003"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.593901, 9.98506]}, "properties": {"InvertElev": 38.4, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120004"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.593923, 9.985115]}, "properties": {"InvertElev": 38.29, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120005"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.593963, 9.985222]}, "properties": {"InvertElev": 38.32, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120006"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.593997, 9.985308]}, "properties": {"InvertElev": 38.3, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120007"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.593974, 9.985315]}, "properties": {"InvertElev": 38.44, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120008"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.593882, 9.984992]}, "properties": {"InvertElev": 38.5, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120010"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594006, 9.985019]}, "properties": {"InvertElev": 38.36, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120011"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594184, 9.985332]}, "properties": {"InvertElev": 38.22, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120012"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594154, 9.985249]}, "properties": {"InvertElev": 38.22, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120013"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594054, 9.985286]}, "properties": {"InvertElev": 38.26, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120014"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594214, 9.985378]}, "properties": {"InvertElev": 38.22, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120015"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594112, 9.985422]}, "properties": {"InvertElev": 38.12, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120016"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594083, 9.985357]}, "properties": {"InvertElev": 38.32, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120017"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.59413, 9.985169]}, "properties": {"InvertElev": 38.58, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120018"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.59403, 9.985207]}, "properties": {"InvertElev": 38.39, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120019"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594024, 9.985194]}, "properties": {"InvertElev": 38.33, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120020"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.593923, 9.984977]}, "properties": {"InvertElev": 38.37, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120021"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594116, 9.985008]}, "properties": {"InvertElev": 38.34, "MaxDepth": 0.0, "InitDepth": 0.0, "SurchargeDepth": 0.0, "PondedArea": 0.0, "Name": "120022"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594143, 9.985485]}, "properties": {"InvertElev": 36.42, "OutfallType": "FREE", "StageOrTimeseries": "NO", "Name": "119016PW01"}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [6.594695, 9.985335]}, "properties": {"InvertElev": 35.48, "OutfallType": "FREE", "StageOrTimeseries": "NO", "Name": "119040PW01"}}]}
var sewer_source, node_source;

map.on('load', function() {

    // load the data into the map
    sewer_source = map.addSource('sewer-data', {'type': 'geojson', 'data': conduits});
    node_source =  map.addSource('node-data',  {'type': 'geojson', 'data': nodes});

    map.addLayer({
      "id": "sewer",
      'type': 'line',
      "source": "sewer-data",
      'paint': {
          'line-color': [
              "interpolate-hcl", [ "linear" ], ["number",  [ "get", "MaxQPerc" ], 0],
              0, '#5cd66e' ,  1, '#dde639' ,  2, '#e64839',
          ],
          'line-opacity': 0.85,
          'line-width': [
          'interpolate', [ "exponential", 10 ], [ 'zoom' ],
          10, [ "ln", ["+", [ "get", "MaxQ" ], 1]],
          15, [ "ln", ["+", [ "get", "MaxQ" ], 1]],
        ],
      }
    });

    map.addLayer({
        "id": "sewer-hover",
        'type': 'line',
        "source": "sewer-data",
        'paint': {
            'line-color': "#8384a4",
            'line-opacity': 1,
            'line-width':4,
        },
        'filter':["==", "'InletNode'", ""],
    });

    map.addLayer({
        "id": "node",
        'type': 'circle',
        "source": "node-data",
        'paint': {
            'circle-color': '#1182d9',
            'circle-opacity': 0.75,
            'circle-radius':3,
        }
    });

    // When a click event occurs near a polygon, open a popup at the location of
    // the feature, with description HTML from its properties.
    map.on('click', function (e) {
        //create a buffer to forgive those clumsy clicks
        var x = e.point.x;
        var y = e.point.y;
        var clickbox = [[x-10, y-10], [x+10, y+10]]

        var features = map.queryRenderedFeatures(clickbox, { layers: ['sewer', 'node'] });
        if (!features.length) {
            map.setFilter("sewer-hover", ["==", "Name", ""]);
            return;
        }

        var feature = features[0];
        console.log(feature)

        // highlight whats been clicked
        map.setFilter("sewer-hover", ["==", "Name", feature.properties.Name]);
        html_message_start = '<strong>' + feature.properties.Name + '</strong><hr>';
        html_message = [];
        Object.keys(feature.properties).forEach(function(key) {
            html_message.push(key + ': ' + feature.properties[key]);
        });
        html_message = html_message_start + html_message.join('<br>');

        var popup = new mapboxgl.Popup()
            .setLngLat(map.unproject(e.point))
            .setHTML(html_message)
            .addTo(map);
    });
    // Use the same approach as above to indicate that the symbols are clickable
    // by changing the cursor style to 'pointer'
    map.on('mousemove', function (e) {
        var features = map.queryRenderedFeatures(e.point, { layers: ['sewer'] });
        if (features.length==0) {
            return;
        }
        map.getCanvas().style.cursor = (features.length) ? 'pointer' : '';
    });
});

</script>
</body>
</html>
